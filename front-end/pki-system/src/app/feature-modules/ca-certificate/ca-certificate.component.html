<div class="container">
  <h1 class="title">Create CA certificate</h1>
<br>
<h2 class="titlec">Clients</h2>
  <div>
      <table>
        <thead>
            <tr>
                <th>Full name</th>
                <th>Mail</th>
                <th>Organization unit</th>
                <th>Country</th>
            </tr>
        </thead>
          <tbody>
              <tr *ngFor="let user of users" 
                  (click)="onUserSelect(user)" 
                  [class.selected]="user === selectedUser">
                  <td>{{ user.commonName }}</td> 
                  <td>{{ user.mail }}</td>
                  <td>{{ user.organizationUnit }}</td>                  
                  <td>{{ user.country }}</td>
              </tr>
          </tbody>
      </table>
  </div>
  <div class="date-picker" [ngClass]="{'invalid-range': isInvalidDateRange()}">
      <label class="startDateLabel">Start Date</label>
      <input type="date" id="startDate" name="startDate" class="startDate" [(ngModel)]="startDate" (change)="startDateSelected()"><br><br>
      <label class="endDateLabel">End Date</label>
      <input type="date" id="endDate" name="endDate" class="endDate" [(ngModel)]="endDate" (change)="endDateSelected()"><br><br>      
  </div> 
    <button [disabled]="!selectedUser" class="choose" (click)="chooseCertificate()">Select certificate</button>
    <br>

  <div *ngIf="certiciateButtonSelected">
  <div >
    <table>
        <thead>
            <tr>
                <th>certificateType</th>
                <th>issuerMail</th>
                <th>subjectMail</th>
                <th>startDate</th>
                <th>endDate</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let cert of certificates" 
                (click)="onCertSelect(cert)" 
                [class.selected]="cert === selectedCert"
                [class.duplicate]="cert.issuerMail === selectedUser.mail || cert.subjectMail === selectedUser.mail ">
                <td>{{ cert.certificateType }}</td>
                <td>{{ cert.issuerMail }}</td>
                <td>{{ cert.subjectMail }}</td>                   
                <td>{{ cert.startDate | date: 'mediumDate' }}</td>
                <td>{{ cert.endDate | date: 'mediumDate' }}</td>
            </tr>
        </tbody>
    </table>
</div>
<div class="extensions">
    <div class="keyUsages">
        <p class="keyUsagesLabel"><b>Key Usages</b></p>
        <label><input type="checkbox" [(ngModel)]="keyUsage.DIGITAL_SIGNATURE"> Digital signature</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.NON_REPUDIATION"> Non-repudiation</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.KEY_ENCIPHER"> Key encipherment</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.DATA_ENCIPHER"> Data encipherment</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.KEY_AGREEMENT"> Key agreement</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.CERTIFICATE_SIGNING"> Certificate signing</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.CRL_SIGNING"> CRL signing</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.ENCIPHER_ONLY"> Encipher only</label><br>
        <label><input type="checkbox" [(ngModel)]="keyUsage.DECIPHER_ONLY"> Decipher only</label><br>
    </div>

    
    <div class="extendedKeyUsages">
        <p class="extendedKeyUsagesLabel"><b>Extended Key Usages</b></p>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.TSL_WEB_SERVER_AUTHENTICATION"> TLS Web server authentication</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.TLS_WEB_CLIENT_AUTHENTICATION"> TLS Web client authentication</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.SIGN_EXECUTABLE_CODE"> Sign (downloadable) executable code</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.EMAIL_PROTECTION"> Email protection</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.IPSEC_END_SYSTEM"> IPSEC End System (host or router)</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.IPSEC_TUNNEL"> IPSEC Tunnel</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.IPSEC_USER"> IPSEC User</label><br>
        <label><input type="checkbox" [(ngModel)]="extendedKeyUsage.TIMESTAMPING"> Timestamping</label><br>
    </div>
</div>    
<br>
<br>
<br>
<div class="filePass-container">
    <label class="filePass">File password</label>
    <input type="password" id="filePass" name="filePass" class="filePassfield" [(ngModel)]="filePass">
</div>
  
<br>

  <button class="create" (click)="onCreate()"  [disabled]="!selectedCert">Create</button>
</div>
</div>
